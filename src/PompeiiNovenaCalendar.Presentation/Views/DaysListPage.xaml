<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:Resources="clr-namespace:PompeiiNovenaCalendar.Presentation.Resources.Localization"
             x:Class="PompeiiNovenaCalendar.Presentation.Views.DaysListPage"
             Appearing="ContentPage_Appearing"
             Title="{x:Static Resources:Strings.DaysListPageTitle}">
    <ContentPage.ToolbarItems>
        <ToolbarItem Text="{Binding DaysLengthToEndText}"
                     Order="Primary"
                     Priority="0"
                     />
        <ToolbarItem Text="{x:Static Resources:Strings.Reset}"
                     IconImageSource="remove_icon.png"
                     Command="{Binding ResetDaysCommand}" />
    </ContentPage.ToolbarItems>
    <CollectionView ItemsSource="{Binding Days}">
        <CollectionView.ItemTemplate>
            <DataTemplate>
                <StackLayout Padding="10" >
                    <Grid Margin="10" ColumnDefinitions="2*, 1*, 1*" >
                        <Label Grid.Column="0" 
                               FontSize="Medium" 
                               HorizontalTextAlignment="Center" 
                               Margin="5, 15" 
                               Text="{Binding Day, StringFormat='{0:dddd, dd MMMM}'}" />
                        <Button Grid.Column="1" 
                                FontSize="Medium" 
                                Margin="5, 0" 
                                Text="{Binding VisibilityButtonText}" 
                                Command="{Binding ToogleVisibilityCommand}" />
                        <Label Grid.Column="2" Margin="5, 15" FontSize="Medium" HorizontalTextAlignment="End" Text="{Binding StatusName}" />
                    </Grid>
                    <StackLayout>

                        <CollectionView IsVisible="{Binding IsVisible}" ItemsSource="{Binding RosarySelections}" x:Name="RosaryCollection">
                            <CollectionView.ItemTemplate>
                                <DataTemplate>
                                    <StackLayout Orientation="Horizontal" >
                                        <CheckBox 
                                            IsChecked="{Binding IsCompleted}"  
                                            CheckedChanged="CheckBox_CheckedChanged"
                                            AutomationId="{Binding Id}"
                                            Margin="50, 0, 0, 0" />
                                        <Label Text="{Binding Name}" FontSize="Medium" Margin="15, 5, 0, 0"/>
                                    </StackLayout>
                                </DataTemplate>
                            </CollectionView.ItemTemplate>
                        </CollectionView>

                    </StackLayout>
                </StackLayout>
            </DataTemplate>
        </CollectionView.ItemTemplate>
    </CollectionView>
</ContentPage>